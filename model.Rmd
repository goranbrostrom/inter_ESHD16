--- title: "Models for intergenerational transmissions in infant mortality" 
author: "Göran Broström" date: "August 10, 2016" output: html_document ---

```{r setup, include=FALSE} knitr::opts_chunk$set(echo = TRUE) ```

# The data

There are data on births and infant deaths for mothers and their grandmothers.
More specifically, we have, for each mother, the following information:

* n: Number of births * $T_1, \ldots, T_n$: Life lengths of the born kids.
Censored at the age of one year, numbered according to birth order. * $D_1,
\dots, D_n$: Indicators of $T_j < 1, \; j = 1, \ldots, n$ * $Z$: The number
infant deaths facing the corresponding grandmother. * $n_Z$: Grandmother's
number of births. * $\mathbf{x}$: A vector of covariates.

The explanatory variable $(Z, n_Z)$ is of primary interest. And since we are
interested of its effect on "infant mortality", it is natural to restrict
attention to $D_1, \ldots, D_n$ as response, but it is also possible to
complicate things and try to model the complete data set.

# A binary model

If we assume that, given the mother, $T_1, \ldots, T_n$ are independent random
variables with survivor function $S_j$, then we have that $D_1, \ldots, D_n$ are
independent Bernoulli random variables with

$$ P(D_j = 1) = P(T_j >= 1) = S_j(1), \quad j = 1, \ldots, n. $$

Assuming that the relation between these survivor functions follow a
*proportional hazards* model, i.e.,

$$ S_j(1) = q^{k_j}, \quad j = 1, \ldots, n, $$ for some real number $0 < q <
1$, then, assuming proportional hazards relations visavi all covariates, we get 
$$ P(Z, \mathbf{x}, j) = P(T_j < 1; Z, x) = 1 - \exp(-e^{\alpha + \beta g(Z,
n_Z) + \boldsymbol{\gamma} \mathbf{x}}), $$ where $g$ is a suitable function,
for instance $$ g(Z, n_Z) = \frac{Z}{n_Z} = \bar{Z}, $$ and the parity
information is absorbed into $\mathbf{x}$. The likelihood contribution from one
mother (number $i$, say) is then

$$ L_i(\alpha, \beta, \boldsymbol{\gamma} \mid \mathbf{D}_i) = \prod_{j=1}^n
\bigl\{1 - \exp(-e^{\alpha + \beta g(Z, n_Z) + \boldsymbol{\gamma}
\mathbf{x}})\bigr\}^{D_i} \bigl\{\exp(-e^{\alpha + \beta g(Z, n_Z) +
\boldsymbol{\gamma} \mathbf{x}})\bigr\}^{1-D_i} $$

We recognize this as the likelihood kernel of a *Bernuolli* model with the
*cloglog* link function, that is, *logistic regression* with a cloglog link.
There one problem with this, though: With data from only one mother (as above),
the model is not identifiable, because the variable $Z$ is constant over the
mother. We can estimate $\alpha + \beta g(Z, n_Z)$, but not isolate the effect
of $(Z, n_Z)$. With data from many mothers we can solve this dilemma in two
ways: (i) Let $\alpha$ be constant over mothers, or (ii) fit a *random effects
model*, where $\alpha_1, \ldots, \alpha_N$ are regarded as a random sample from
som suitable distribution with finite variance. Method (i) is clearly
unsatisfactory (would require an assumption about total independence), but (ii)
is possibe without strong assumptions.

## A *simple* binary model

A very simple and straightforward model, that requires no restrictive
assumptions, is to skip all covariates and have as explanatory variable

$$ R = g(Z, n_Z) = I(Z > 0) $$ and response $$ Y = I\biggl(\sum_{j=1}^n D_j >
0\biggr) $$

where $I(A)$ is the indicator function of the event $A$, equal to unity if $A$
is *TRUE*, zero otherwise. The analysis will then boil down to a $\chi^2$ test
in a $2\times 2$ table, see my blog post
[Inheritance](http://capa.ddb.umu.se/rr/jekyll/rstats/2016/06/01/inheritance.html)
for an example.


# A survival analysis approach

In this approach we utilize the full data set $(T_i, D_i), i = 1, \ldots, n$ and
a proportional hazards assumption, as in the binary approach. The research
question is then more indirect: "Does grandmother's infant deaths affect the
life length of mother's children, restricted to the first year of life?"

The same identifiability problem as above shows here, and it can be handled in
essentially the same way, that is (ii) is the preferred way.

# Summing up

So, we have (at least) three possible models to our disposal; which one should we choose?
My maxim is *the simpler, the better*, which would point to the $2\times 2$ table above, but it is clearly OK to apply one of the more elaborate models, if one is willing to investigate the necessary model checks (*proportional hazards*, *conditional independence*, etc.).

But, whatever our choice is, I recommend employing the simple model as a sanity check: If it shows a  completely different result, we should be worried.

# Application

I exemplify with the data from Skellefteå. It looks like this:

```{r datamoth, echo = FALSE}
load("data/mothersrda")
head(mothers)
```

## The binary model

